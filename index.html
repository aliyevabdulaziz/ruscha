<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Учитесь в топовых университетах мира без стресса</title>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div class="container hero-container">
			<section class="hero-section">
				<div class="hero-content">
					<h1 class="hero-title">Учитесь в топовых университетах мира без стресса!"</h1>
					<p class="hero-subtitle">Сайдкарим помог десяткам студентов поступить в Италию, США и Европу. Ваша очередь!</p>

					<div class="form-container">
						<form name="submit-to-google-sheet" id="consultationForm">
							<div class="form-row">
								<div class="form-group">
									<label class="form-label" for="name">Ваше имя</label>
									<input name="name" type="text" id="name" class="form-input" placeholder="Ismingiz" required />
								</div>

								<div class="form-group">
									<label class="form-label" for="phone">Номер телефона</label>
									<input type="tel" name="tel" id="phone" class="form-input" placeholder="+998" value="+998 " required />
								</div>
							</div>

							<a href="next.html" type="submit" class="cta-button">
								<img src="img/play.svg" alt="icon" />
								Посмотреть видео
							</a>
						</form>
					</div>
				</div>

				<div class="hero-image">
					<div class="consultant-image">
						<div class="consultant-photo"></div>
					</div>
				</div>
			</section>
		</div>

		<div class="container">
			<div class="form-container flex">
				<form name="submit-to-google-sheet" id="consultationForm">
					<div class="form-row">
						<div class="form-group">
							<label class="form-label" for="name">Ваше имя</label>
							<input name="name" type="text" id="name" class="form-input" placeholder="Ismingiz" required />
						</div>

						<div class="form-group">
							<label class="form-label" for="phone">Номер телефона</label>
							<input
								type="tel"
								name="tel"
								id="phone1"
								pattern="[0-9]*"
								class="form-input"
								placeholder="+998"
								value="+998 "
								required />
						</div>
					</div>

					<button type="submit" class="cta-button">
						<img src="img/play.svg" alt="" />
						Посмотреть видео
					</button>
				</form>
			</div>
		</div>

		<script src="main.js" defer></script>

		<script>
			const scriptURL = '';
			const form = document.forms['submit-to-google-sheet'];

			form.addEventListener('submit', e => {
				e.preventDefault()
					.fetch(scriptURL, { method: 'POST', body: new FormData(form) })
					.then(response => console.log('Success!', response))
					.catch(error => console.error('Error!', error.message));
			});
		</script>

		<script>
			document.querySelector('.cta-button').addEventListener('click', function (e) {
				e.preventDefault();

				const name = document.getElementById('name').value.trim();
				const phone = document.getElementById('phone').value.trim();

				// Oddiy validatsiya
				if (name === '' || phone === '' || !phone.startsWith('+998') || phone.length < 13) {
					alert('Iltimos, to‘g‘ri ism va telefon raqamini kiriting.');
					return;
				} else {
					localStorage.setItem('userName', name);
					localStorage.setItem('userPhone', phone);
					window.location.href = 'next.html';
				}

				// Ma'lumotni Google Sheets ga yuborish
			});

			const button = document.querySelector('.cta-button');
			document.getElementById('consultationForm').addEventListener('submit', function (e) {
				e.preventDefault();

				const name = document.getElementById('name').value.trim();
				const phone = document.getElementById('phone').value.trim();

				if (name && phone) {
					// Simulate form submission
					const originalText = button.innerHTML;

					button.innerHTML = '<span class="play-icon">⏳</span> Отправка...';
					button.disabled = true; // Redirect to next page after submission
					// Redirect to next page
					setTimeout(() => {
						alert(`Спасибо, ${name}! Мы свяжемся с вами по номеру ${phone} в ближайшее время.`);
						button.innerHTML = originalText;
						button.disabled = false;
						this.reset();
						document.getElementById('phone').value = '+998 ';
						// localStorage orqali saqlash
						localStorage.setItem('userName', name);
						localStorage.setItem('userPhone', phone);

						// keyingi sahifaga o'tish
						window.location.href = 'next.html';
					}, 2000);
				} else {
					alert('Пожалуйста, заполните все поля');
				}
			});

			document.querySelector('.cta-button').addEventListener('click', function (e) {
				e.preventDefault();

				const name = document.getElementById('name').value.trim();
				const phone = document.getElementById('phone').value.trim();

				// Oddiy validatsiya
				if (name === '' || phone === '' || !phone.startsWith('+998') || phone.length < 13) {
					alert('Iltimos, to‘g‘ri ism va telefon raqamini kiriting.');
					return;
				} else {
					localStorage.setItem('userName', name);
					localStorage.setItem('userPhone', phone);
					window.location.href = 'next.html';
				}

				// Ma'lumotni Google Sheets ga yuborish
			});

			document.getElementById('consultationForm').addEventListener('submit', function (e) {
				e.preventDefault();

				const name = document.getElementById('name').value.trim();
				const phone = document.getElementById('phone1').value.trim();

				if (name && phone) {
					// Simulate form submission
					const originalText = button.innerHTML;

					button.innerHTML = '<span class="play-icon">⏳</span> Отправка...';
					button.disabled = true; // Redirect to next page after submission
					// Redirect to next page
					setTimeout(() => {
						alert(`Спасибо, ${name}! Мы свяжемся с вами по номеру ${phone} в ближайшее время.`);
						button.innerHTML = originalText;
						button.disabled = false;
						this.reset();
						document.getElementById('phone1').value = '+998 ';
						// localStorage orqali saqlash
						localStorage.setItem('userName', name);
						localStorage.setItem('userPhone', phone);

						// keyingi sahifaga o'tish
						window.location.href = 'next.html';
					}, 2000);
				} else {
					alert('Пожалуйста, заполните все поля');
				}
			});

			// Phone number formatting
			document.getElementById('phone').addEventListener('input', function (e) {
				let value = e.target.value;

				if (!value.startsWith('+998')) {
					value = '+998 ' + value.replace(/[^0-9]/g, '');
				}

				const prefix = '+998 ';
				const numberPart = value
					.substring(prefix.length)
					.replace(/[^0-9]/g, '')
					.substring(0, 9);

				let formatted = prefix;
				if (numberPart.length >= 2) formatted += numberPart.substring(0, 2);
				if (numberPart.length >= 5) formatted += ' ' + numberPart.substring(2, 5);
				if (numberPart.length >= 7) formatted += ' ' + numberPart.substring(5, 7);
				if (numberPart.length >= 9) formatted += ' ' + numberPart.substring(7, 9);

				e.target.value = formatted;

				// Kursorni oxiriga qo‘yish
				setTimeout(() => {
					e.target.setSelectionRange(e.target.value.length, e.target.value.length);
				}, 0);
			});

			document.addEventListener('DOMContentLoaded', function () {
				const phoneInput = document.getElementById('phone');
				if (phoneInput && phoneInput.value.trim() === '') {
					phoneInput.value = '+998 ';
				}
			});
			document.getElementById('phone').addEventListener('focus', function () {
				if (!this.value.startsWith('+998')) {
					this.value = '+998 ';
				}
			});

			document.getElementById('phone1').addEventListener('input', function (e) {
				let value = e.target.value;

				if (!value.startsWith('+998')) {
					value = '+998 ' + value.replace(/[^0-9]/g, '');
				}

				const prefix = '+998 ';
				const numberPart = value
					.substring(prefix.length)
					.replace(/[^0-9]/g, '')
					.substring(0, 9);

				let formatted = prefix;
				if (numberPart.length >= 2) formatted += numberPart.substring(0, 2);
				if (numberPart.length >= 5) formatted += ' ' + numberPart.substring(2, 5);
				if (numberPart.length >= 7) formatted += ' ' + numberPart.substring(5, 7);
				if (numberPart.length >= 9) formatted += ' ' + numberPart.substring(7, 9);

				e.target.value = formatted;

				// Kursorni oxiriga qo‘yish
				setTimeout(() => {
					e.target.setSelectionRange(e.target.value.length, e.target.value.length);
				}, 0);
			});

			document.addEventListener('DOMContentLoaded', function () {
				const phoneInput = document.getElementById('phone1');
				if (phoneInput && phoneInput.value.trim() === '') {
					phoneInput.value = '+998 ';
				}
			});
			document.getElementById('phone1').addEventListener('focus', function () {
				if (!this.value.startsWith('+998')) {
					this.value = '+998 ';
				}
			});
			// Initialize phone input with +998 prefix
			document.addEventListener('DOMContentLoaded', function () {
				document.getElementById('phone1').value = '+998 ';
			});
		</script>
	</body>
</html>
